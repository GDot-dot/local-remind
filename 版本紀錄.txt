line_bot 機器人1.0 2025/12/15
🤖 核心功能總覽
1. AI 智慧大腦 (Google Gemini)
自然語言指令：不用背格式，直接說「明天早上九點提醒我開會」、「20分鐘後關火」、「下週五晚上訂餐廳」，AI 自動解析時間與內容。
關鍵字過濾：只有訊息包含「明天、幾點、提醒、幫我...」等關鍵字時才啟動 AI，在群組聊天時不會浪費額度。
防呆機制：自動清洗 AI 回傳的 Markdown 符號，確保 JSON 解析 100% 成功。
2. 全方位提醒系統
單次提醒：基礎的時間到推播。
重要提醒：紅色/黃色/綠色等級區分，若不確認會持續追殺提醒。
週期提醒：每週固定時間（如：每週一、三 10:00）重複提醒。
延後功能 (Snooze)：
固定延後：一鍵延後 5 分鐘。
自訂延後：使用時間滾輪選擇想要延後到的具體時間。
3. 提醒清單管理
分頁瀏覽：超過 10 筆自動分頁。
狀態過濾：自動隱藏「已完成」或「尚未設定時間」的任務，保持清單乾淨。
一鍵刪除：清單中可直接點擊 ❌ 刪除特定任務。
4. 地點小幫手
儲存地點：傳送 LINE 位置訊息即可儲存（如：停車位、公司）。
找地點：輸入名稱，機器人回傳地圖定位。
✨ 精心打磨的「魔鬼細節」 (UX & 穩定性)
1. 視窗狀態感知 (Context Aware) 🤫
群組防吵：在群組中，如果 AI 聽不懂（例如大家在閒聊），機器人會保持安靜 (已讀不回)。
私訊引導：在私訊中，如果聽不懂，機器人會貼心回覆引導語或 help。
精準推播：群組設定的提醒回群組，私訊設定的回私訊，不會搞混。
2. 延後狀態可視化 💤
當按下「延後」後，程式會更新資料庫內容。
提醒清單中，該任務的圖示會變成 💤，且名稱前方自動加上 (延)，讓使用者一眼看出哪些是拖延的任務。
3. 資料庫自動潔癖 🧹
當 AI 解析完詢問時間時，若使用者選擇 「不提醒」，系統會直接刪除該筆資料，而不是留著佔用空間。
4. 伺服器自我修復 (Self-Healing) 🛠️
斷線重連：資料庫連線若逾時 (SSL closed)，程式會自動偵測並重連 (pool_pre_ping)，確保指令不遺漏。
排程復活：每次伺服器重啟（如 Fly.io 更新），程式會自動掃描資料庫，把所有「未來的任務」和「週期任務」重新註冊回排程器。
5. 時區與時間精準度 ⏰
強制台北時間：清單顯示時強制轉換為 Asia/Taipei，避免看到 UTC 時間。
精準比對：使用 Timestamp (時間戳記) 來判斷是否延後，不受時區格式影響。
🏗️ 技術架構
平台：Fly.io (Docker + Gunicorn) - 高效能、不休眠。
資料庫：Neon (PostgreSQL) - 雲端儲存，資料不丟失。
AI：Google Gemini (flash-latest) - 速度快、額度足。